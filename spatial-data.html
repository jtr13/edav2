<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 13 Spatial data | edav.info, 2nd edition</title>
  <meta name="description" content="Supplemental resources for GR5293 and GR5702" />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 13 Spatial data | edav.info, 2nd edition" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Supplemental resources for GR5293 and GR5702" />
  <meta name="github-repo" content="jtr13/edav2" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 13 Spatial data | edav.info, 2nd edition" />
  
  <meta name="twitter:description" content="Supplemental resources for GR5293 and GR5702" />
  

<meta name="author" content="Joyce Robbins" />


<meta name="date" content="2022-04-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="multidimensional-categorical-variables.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script>
<link href="libs/parallel-coordinates-2.1.8/parcoords.css" rel="stylesheet" />
<script src="libs/parcoords-binding-1.0.0/parcoords.js"></script>
<script src="libs/d3-5.16.0/d3.min.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">edav.info v2</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome!<span></span></a></li>
<li class="part"><span><b>I R resources<span></span></b></span></li>
<li class="chapter" data-level="2" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>2</b> Getting started<span></span></a><ul>
<li class="chapter" data-level="2.1" data-path="getting-started.html"><a href="getting-started.html#top-10-essentials-checklist"><i class="fa fa-check"></i><b>2.1</b> Top 10 essentials checklist<span></span></a></li>
<li class="chapter" data-level="2.2" data-path="getting-started.html"><a href="getting-started.html#troubleshooting"><i class="fa fa-check"></i><b>2.2</b> Troubleshooting<span></span></a><ul>
<li class="chapter" data-level="2.2.1" data-path="getting-started.html"><a href="getting-started.html#document-doesnt-knit"><i class="fa fa-check"></i><b>2.2.1</b> Document doesn’t knit<span></span></a></li>
<li class="chapter" data-level="2.2.2" data-path="getting-started.html"><a href="getting-started.html#functions-stop-working"><i class="fa fa-check"></i><b>2.2.2</b> Functions stop working<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="getting-started.html"><a href="getting-started.html#tips-tricks"><i class="fa fa-check"></i><b>2.3</b> Tips &amp; tricks<span></span></a><ul>
<li class="chapter" data-level="2.3.1" data-path="getting-started.html"><a href="getting-started.html#knitr"><i class="fa fa-check"></i><b>2.3.1</b> knitr<span></span></a></li>
<li class="chapter" data-level="2.3.2" data-path="getting-started.html"><a href="getting-started.html#sizing-figures"><i class="fa fa-check"></i><b>2.3.2</b> Sizing figures<span></span></a></li>
<li class="chapter" data-level="2.3.3" data-path="getting-started.html"><a href="getting-started.html#r-studio-keyborad-shortcuts"><i class="fa fa-check"></i><b>2.3.3</b> R studio keyborad shortcuts<span></span></a></li>
<li class="chapter" data-level="2.3.4" data-path="getting-started.html"><a href="getting-started.html#viewing-plots-in-plot-window"><i class="fa fa-check"></i><b>2.3.4</b> Viewing plots in plot window<span></span></a></li>
<li class="chapter" data-level="2.3.5" data-path="getting-started.html"><a href="getting-started.html#adding-figures-and-links"><i class="fa fa-check"></i><b>2.3.5</b> Adding figures and links<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="working-with-factors.html"><a href="working-with-factors.html"><i class="fa fa-check"></i><b>3</b> Working with factors<span></span></a><ul>
<li class="chapter" data-level="3.1" data-path="working-with-factors.html"><a href="working-with-factors.html#recode-factor-levels"><i class="fa fa-check"></i><b>3.1</b> Recode factor levels<span></span></a></li>
<li class="chapter" data-level="3.2" data-path="working-with-factors.html"><a href="working-with-factors.html#relevel-the-factor"><i class="fa fa-check"></i><b>3.2</b> Relevel the factor<span></span></a></li>
<li class="chapter" data-level="3.3" data-path="working-with-factors.html"><a href="working-with-factors.html#reorder-the-factors"><i class="fa fa-check"></i><b>3.3</b> Reorder the factors<span></span></a></li>
<li class="chapter" data-level="3.4" data-path="working-with-factors.html"><a href="working-with-factors.html#dealing-wirh-nas"><i class="fa fa-check"></i><b>3.4</b> Dealing wirh NAs<span></span></a></li>
<li class="chapter" data-level="3.5" data-path="working-with-factors.html"><a href="working-with-factors.html#summary-of-useful-functions"><i class="fa fa-check"></i><b>3.5</b> Summary of useful functions<span></span></a></li>
<li class="chapter" data-level="3.6" data-path="working-with-factors.html"><a href="working-with-factors.html#continuous-to-categorical"><i class="fa fa-check"></i><b>3.6</b> Continuous to Categorical<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-transformation.html"><a href="data-transformation.html"><i class="fa fa-check"></i><b>4</b> Data transformation<span></span></a><ul>
<li class="chapter" data-level="4.1" data-path="data-transformation.html"><a href="data-transformation.html#what-is-tidy-data"><i class="fa fa-check"></i><b>4.1</b> What is tidy data?<span></span></a></li>
<li class="chapter" data-level="4.2" data-path="data-transformation.html"><a href="data-transformation.html#pivot_longer"><i class="fa fa-check"></i><b>4.2</b> <code>pivot_longer</code><span></span></a></li>
<li class="chapter" data-level="4.3" data-path="data-transformation.html"><a href="data-transformation.html#pivot_wider"><i class="fa fa-check"></i><b>4.3</b> <code>pivot_wider</code><span></span></a></li>
<li class="chapter" data-level="4.4" data-path="data-transformation.html"><a href="data-transformation.html#basic-transformation-functions"><i class="fa fa-check"></i><b>4.4</b> Basic transformation functions<span></span></a><ul>
<li class="chapter" data-level="4.4.1" data-path="data-transformation.html"><a href="data-transformation.html#rename"><i class="fa fa-check"></i><b>4.4.1</b> <code>rename</code><span></span></a></li>
<li class="chapter" data-level="4.4.2" data-path="data-transformation.html"><a href="data-transformation.html#select"><i class="fa fa-check"></i><b>4.4.2</b> <code>select</code><span></span></a></li>
<li class="chapter" data-level="4.4.3" data-path="data-transformation.html"><a href="data-transformation.html#mutate"><i class="fa fa-check"></i><b>4.4.3</b> <code>mutate</code><span></span></a></li>
<li class="chapter" data-level="4.4.4" data-path="data-transformation.html"><a href="data-transformation.html#select-1"><i class="fa fa-check"></i><b>4.4.4</b> <code>select</code><span></span></a></li>
<li class="chapter" data-level="4.4.5" data-path="data-transformation.html"><a href="data-transformation.html#arrange"><i class="fa fa-check"></i><b>4.4.5</b> <code>arrange</code><span></span></a></li>
<li class="chapter" data-level="4.4.6" data-path="data-transformation.html"><a href="data-transformation.html#group_by-and-summarize"><i class="fa fa-check"></i><b>4.4.6</b> <code>group_by</code> and <code>summarize</code><span></span></a></li>
<li class="chapter" data-level="4.4.7" data-path="data-transformation.html"><a href="data-transformation.html#slice_max-slice_min"><i class="fa fa-check"></i><b>4.4.7</b> <code>slice_max</code> (<code>slice_min</code>)<span></span></a></li>
<li class="chapter" data-level="4.4.8" data-path="data-transformation.html"><a href="data-transformation.html#join"><i class="fa fa-check"></i><b>4.4.8</b> join<span></span></a></li>
<li class="chapter" data-level="4.4.9" data-path="data-transformation.html"><a href="data-transformation.html#cases-to-tables"><i class="fa fa-check"></i><b>4.4.9</b> Cases to tables<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="gitgithub-resources.html"><a href="gitgithub-resources.html"><i class="fa fa-check"></i><b>5</b> git/GitHub resources<span></span></a></li>
<li class="part"><span><b>II R graphics<span></span></b></span></li>
<li class="chapter" data-level="6" data-path="learning-ggplot2.html"><a href="learning-ggplot2.html"><i class="fa fa-check"></i><b>6</b> Learning ggplot2<span></span></a><ul>
<li class="chapter" data-level="6.1" data-path="learning-ggplot2.html"><a href="learning-ggplot2.html#getting-started-1"><i class="fa fa-check"></i><b>6.1</b> <strong>Getting started</strong><span></span></a></li>
<li class="chapter" data-level="6.2" data-path="learning-ggplot2.html"><a href="learning-ggplot2.html#default-part-layer"><i class="fa fa-check"></i><b>6.2</b> <strong>Default part: layer</strong><span></span></a></li>
<li class="chapter" data-level="6.3" data-path="learning-ggplot2.html"><a href="learning-ggplot2.html#customized-parts"><i class="fa fa-check"></i><b>6.3</b> <strong>Customized parts</strong><span></span></a><ul>
<li class="chapter" data-level="6.3.1" data-path="learning-ggplot2.html"><a href="learning-ggplot2.html#geometric-object-statistical-transformation-and-position-adjustment"><i class="fa fa-check"></i><b>6.3.1</b> <strong>Geometric object, statistical transformation and position adjustment</strong><span></span></a></li>
<li class="chapter" data-level="6.3.2" data-path="learning-ggplot2.html"><a href="learning-ggplot2.html#scale"><i class="fa fa-check"></i><b>6.3.2</b> <strong>Scale</strong><span></span></a></li>
<li class="chapter" data-level="6.3.3" data-path="learning-ggplot2.html"><a href="learning-ggplot2.html#coordinate-system"><i class="fa fa-check"></i><b>6.3.3</b> <strong>Coordinate system</strong><span></span></a></li>
<li class="chapter" data-level="6.3.4" data-path="learning-ggplot2.html"><a href="learning-ggplot2.html#faceting"><i class="fa fa-check"></i><b>6.3.4</b> <strong>Faceting</strong><span></span></a></li>
<li class="chapter" data-level="6.3.5" data-path="learning-ggplot2.html"><a href="learning-ggplot2.html#labels"><i class="fa fa-check"></i><b>6.3.5</b> <strong>Labels</strong><span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="learning-ggplot2.html"><a href="learning-ggplot2.html#resources-for-ggplot2"><i class="fa fa-check"></i><b>6.4</b> <strong>Resources for ggplot2</strong><span></span></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="faceting-1.html"><a href="faceting-1.html"><i class="fa fa-check"></i><b>7</b> Faceting<span></span></a><ul>
<li class="chapter" data-level="7.1" data-path="faceting-1.html"><a href="faceting-1.html#faceting-on-one-variable"><i class="fa fa-check"></i><b>7.1</b> Faceting on one variable<span></span></a></li>
<li class="chapter" data-level="7.2" data-path="faceting-1.html"><a href="faceting-1.html#faceting-on-two-variables"><i class="fa fa-check"></i><b>7.2</b> Faceting on two variables<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="unidimensional-continuous-variables.html"><a href="unidimensional-continuous-variables.html"><i class="fa fa-check"></i><b>8</b> Unidimensional continuous variables<span></span></a><ul>
<li class="chapter" data-level="8.1" data-path="unidimensional-continuous-variables.html"><a href="unidimensional-continuous-variables.html#histogram"><i class="fa fa-check"></i><b>8.1</b> Histogram<span></span></a><ul>
<li class="chapter" data-level="8.1.1" data-path="unidimensional-continuous-variables.html"><a href="unidimensional-continuous-variables.html#basics-and-implications"><i class="fa fa-check"></i><b>8.1.1</b> Basics and implications<span></span></a></li>
<li class="chapter" data-level="8.1.2" data-path="unidimensional-continuous-variables.html"><a href="unidimensional-continuous-variables.html#types-of-histograms"><i class="fa fa-check"></i><b>8.1.2</b> Types of histograms<span></span></a></li>
<li class="chapter" data-level="8.1.3" data-path="unidimensional-continuous-variables.html"><a href="unidimensional-continuous-variables.html#parameters-for-geom_histogram"><i class="fa fa-check"></i><b>8.1.3</b> Parameters for geom_histogram<span></span></a></li>
<li class="chapter" data-level="8.1.4" data-path="unidimensional-continuous-variables.html"><a href="unidimensional-continuous-variables.html#interactive-histograms-with-ggvis"><i class="fa fa-check"></i><b>8.1.4</b> Interactive histograms with <code>ggvis</code><span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="unidimensional-continuous-variables.html"><a href="unidimensional-continuous-variables.html#boxplots"><i class="fa fa-check"></i><b>8.2</b> Boxplots<span></span></a><ul>
<li class="chapter" data-level="8.2.1" data-path="unidimensional-continuous-variables.html"><a href="unidimensional-continuous-variables.html#single-boxplot"><i class="fa fa-check"></i><b>8.2.1</b> Single boxplot<span></span></a></li>
<li class="chapter" data-level="8.2.2" data-path="unidimensional-continuous-variables.html"><a href="unidimensional-continuous-variables.html#multiple-boxplots"><i class="fa fa-check"></i><b>8.2.2</b> Multiple boxplots<span></span></a></li>
<li class="chapter" data-level="8.2.3" data-path="unidimensional-continuous-variables.html"><a href="unidimensional-continuous-variables.html#additional-resources"><i class="fa fa-check"></i><b>8.2.3</b> Additional resources<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="unidimensional-continuous-variables.html"><a href="unidimensional-continuous-variables.html#ridgeline-plot"><i class="fa fa-check"></i><b>8.3</b> Ridgeline plot<span></span></a><ul>
<li class="chapter" data-level="8.3.1" data-path="unidimensional-continuous-variables.html"><a href="unidimensional-continuous-variables.html#basics-and-implications-1"><i class="fa fa-check"></i><b>8.3.1</b> Basics and implications<span></span></a></li>
<li class="chapter" data-level="8.3.2" data-path="unidimensional-continuous-variables.html"><a href="unidimensional-continuous-variables.html#create-better-visuals"><i class="fa fa-check"></i><b>8.3.2</b> Create better visuals<span></span></a></li>
<li class="chapter" data-level="8.3.3" data-path="unidimensional-continuous-variables.html"><a href="unidimensional-continuous-variables.html#additional-resources-1"><i class="fa fa-check"></i><b>8.3.3</b> Additional resources<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="unidimensional-continuous-variables.html"><a href="unidimensional-continuous-variables.html#normal-distribution"><i class="fa fa-check"></i><b>8.4</b> Normal distribution<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="unidimensional-categorical-variables.html"><a href="unidimensional-categorical-variables.html"><i class="fa fa-check"></i><b>9</b> Unidimensional categorical variables<span></span></a><ul>
<li class="chapter" data-level="9.1" data-path="unidimensional-categorical-variables.html"><a href="unidimensional-categorical-variables.html#bar-plot"><i class="fa fa-check"></i><b>9.1</b> Bar plot<span></span></a><ul>
<li class="chapter" data-level="9.1.1" data-path="unidimensional-categorical-variables.html"><a href="unidimensional-categorical-variables.html#nominal-data"><i class="fa fa-check"></i><b>9.1.1</b> Nominal data<span></span></a></li>
<li class="chapter" data-level="9.1.2" data-path="unidimensional-categorical-variables.html"><a href="unidimensional-categorical-variables.html#ordinal-data"><i class="fa fa-check"></i><b>9.1.2</b> Ordinal data<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="unidimensional-categorical-variables.html"><a href="unidimensional-categorical-variables.html#cleveland-dot-plot"><i class="fa fa-check"></i><b>9.2</b> Cleveland dot plot<span></span></a><ul>
<li class="chapter" data-level="9.2.1" data-path="unidimensional-categorical-variables.html"><a href="unidimensional-categorical-variables.html#cleveland-dot-plot-with-multiple-dots"><i class="fa fa-check"></i><b>9.2.1</b> Cleveland dot plot with multiple dots<span></span></a></li>
<li class="chapter" data-level="9.2.2" data-path="unidimensional-categorical-variables.html"><a href="unidimensional-categorical-variables.html#cleveland-dot-plot-with-facets"><i class="fa fa-check"></i><b>9.2.2</b> Cleveland dot plot with facets<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="two-continuous-variables.html"><a href="two-continuous-variables.html"><i class="fa fa-check"></i><b>10</b> Two continuous variables<span></span></a><ul>
<li class="chapter" data-level="10.1" data-path="two-continuous-variables.html"><a href="two-continuous-variables.html#scatterplot"><i class="fa fa-check"></i><b>10.1</b> Scatterplot<span></span></a><ul>
<li class="chapter" data-level="10.1.1" data-path="two-continuous-variables.html"><a href="two-continuous-variables.html#basics-and-implications-2"><i class="fa fa-check"></i><b>10.1.1</b> Basics and implications<span></span></a></li>
<li class="chapter" data-level="10.1.2" data-path="two-continuous-variables.html"><a href="two-continuous-variables.html#overplotting"><i class="fa fa-check"></i><b>10.1.2</b> Overplotting<span></span></a></li>
<li class="chapter" data-level="10.1.3" data-path="two-continuous-variables.html"><a href="two-continuous-variables.html#interactive-scatterplot"><i class="fa fa-check"></i><b>10.1.3</b> Interactive scatterplot<span></span></a></li>
<li class="chapter" data-level="10.1.4" data-path="two-continuous-variables.html"><a href="two-continuous-variables.html#modifications"><i class="fa fa-check"></i><b>10.1.4</b> Modifications<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="two-continuous-variables.html"><a href="two-continuous-variables.html#heatmaps"><i class="fa fa-check"></i><b>10.2</b> Heatmaps<span></span></a><ul>
<li class="chapter" data-level="10.2.1" data-path="two-continuous-variables.html"><a href="two-continuous-variables.html#basics-and-implications-3"><i class="fa fa-check"></i><b>10.2.1</b> Basics and implications<span></span></a></li>
<li class="chapter" data-level="10.2.2" data-path="two-continuous-variables.html"><a href="two-continuous-variables.html#modifications-1"><i class="fa fa-check"></i><b>10.2.2</b> Modifications<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="multidimensional-continuous-variables.html"><a href="multidimensional-continuous-variables.html"><i class="fa fa-check"></i><b>11</b> Multidimensional continuous variables<span></span></a><ul>
<li class="chapter" data-level="11.1" data-path="multidimensional-continuous-variables.html"><a href="multidimensional-continuous-variables.html#parallel-coordinate-plot"><i class="fa fa-check"></i><b>11.1</b> Parallel coordinate plot<span></span></a><ul>
<li class="chapter" data-level="11.1.1" data-path="multidimensional-continuous-variables.html"><a href="multidimensional-continuous-variables.html#basics-and-implications-4"><i class="fa fa-check"></i><b>11.1.1</b> Basics and implications<span></span></a></li>
<li class="chapter" data-level="11.1.2" data-path="multidimensional-continuous-variables.html"><a href="multidimensional-continuous-variables.html#modifications-2"><i class="fa fa-check"></i><b>11.1.2</b> Modifications<span></span></a></li>
<li class="chapter" data-level="11.1.3" data-path="multidimensional-continuous-variables.html"><a href="multidimensional-continuous-variables.html#interactive-parallel-coordinate-plot"><i class="fa fa-check"></i><b>11.1.3</b> Interactive parallel coordinate plot<span></span></a></li>
<li class="chapter" data-level="11.1.4" data-path="multidimensional-continuous-variables.html"><a href="multidimensional-continuous-variables.html#external-resource"><i class="fa fa-check"></i><b>11.1.4</b> External resource<span></span></a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="multidimensional-continuous-variables.html"><a href="multidimensional-continuous-variables.html#biplot"><i class="fa fa-check"></i><b>11.2</b> Biplot<span></span></a><ul>
<li class="chapter" data-level="11.2.1" data-path="multidimensional-continuous-variables.html"><a href="multidimensional-continuous-variables.html#principal-components-analysis-pca"><i class="fa fa-check"></i><b>11.2.1</b> Principal components analysis (PCA)<span></span></a></li>
<li class="chapter" data-level="11.2.2" data-path="multidimensional-continuous-variables.html"><a href="multidimensional-continuous-variables.html#draw-a-biplot"><i class="fa fa-check"></i><b>11.2.2</b> Draw a biplot<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="multidimensional-categorical-variables.html"><a href="multidimensional-categorical-variables.html"><i class="fa fa-check"></i><b>12</b> Multidimensional categorical variables<span></span></a><ul>
<li class="chapter" data-level="12.1" data-path="multidimensional-categorical-variables.html"><a href="multidimensional-categorical-variables.html#barcharts"><i class="fa fa-check"></i><b>12.1</b> Barcharts<span></span></a><ul>
<li class="chapter" data-level="12.1.1" data-path="multidimensional-categorical-variables.html"><a href="multidimensional-categorical-variables.html#stacked-bar-chart"><i class="fa fa-check"></i><b>12.1.1</b> Stacked bar chart<span></span></a></li>
<li class="chapter" data-level="12.1.2" data-path="multidimensional-categorical-variables.html"><a href="multidimensional-categorical-variables.html#grouped-bar-chart"><i class="fa fa-check"></i><b>12.1.2</b> Grouped bar chart<span></span></a></li>
<li class="chapter" data-level="12.1.3" data-path="multidimensional-categorical-variables.html"><a href="multidimensional-categorical-variables.html#grouped-bar-chart-with-facets"><i class="fa fa-check"></i><b>12.1.3</b> Grouped bar chart with facets<span></span></a></li>
<li class="chapter" data-level="12.1.4" data-path="multidimensional-categorical-variables.html"><a href="multidimensional-categorical-variables.html#grouped-barchart-with-three-categorical-variables"><i class="fa fa-check"></i><b>12.1.4</b> Grouped barchart with three categorical variables<span></span></a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="multidimensional-categorical-variables.html"><a href="multidimensional-categorical-variables.html#chi-square-test-of-independence"><i class="fa fa-check"></i><b>12.2</b> Chi square test of independence<span></span></a></li>
<li class="chapter" data-level="12.3" data-path="multidimensional-categorical-variables.html"><a href="multidimensional-categorical-variables.html#mosaic-plots"><i class="fa fa-check"></i><b>12.3</b> Mosaic plots<span></span></a><ul>
<li class="chapter" data-level="12.3.1" data-path="multidimensional-categorical-variables.html"><a href="multidimensional-categorical-variables.html#mosaic-plot-with-one-variable"><i class="fa fa-check"></i><b>12.3.1</b> Mosaic plot with one variable<span></span></a></li>
<li class="chapter" data-level="12.3.2" data-path="multidimensional-categorical-variables.html"><a href="multidimensional-categorical-variables.html#mosaic-plot-with-two-variables"><i class="fa fa-check"></i><b>12.3.2</b> Mosaic plot with two variables<span></span></a></li>
<li class="chapter" data-level="12.3.3" data-path="multidimensional-categorical-variables.html"><a href="multidimensional-categorical-variables.html#mosaic-plot-with-three-variablesbest-practice"><i class="fa fa-check"></i><b>12.3.3</b> Mosaic plot with three variables(Best practice)<span></span></a></li>
<li class="chapter" data-level="12.3.4" data-path="multidimensional-categorical-variables.html"><a href="multidimensional-categorical-variables.html#mosaic-pairs-plot"><i class="fa fa-check"></i><b>12.3.4</b> Mosaic pairs plot<span></span></a></li>
<li class="chapter" data-level="12.3.5" data-path="multidimensional-categorical-variables.html"><a href="multidimensional-categorical-variables.html#mosaic-plots-spine-plot"><i class="fa fa-check"></i><b>12.3.5</b> Mosaic plots: spine plot<span></span></a></li>
<li class="chapter" data-level="12.3.6" data-path="multidimensional-categorical-variables.html"><a href="multidimensional-categorical-variables.html#mosaic-plot-tree-map"><i class="fa fa-check"></i><b>12.3.6</b> Mosaic plot: tree map<span></span></a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="multidimensional-categorical-variables.html"><a href="multidimensional-categorical-variables.html#alluvial-diagrams"><i class="fa fa-check"></i><b>12.4</b> Alluvial diagrams<span></span></a><ul>
<li class="chapter" data-level="12.4.1" data-path="multidimensional-categorical-variables.html"><a href="multidimensional-categorical-variables.html#ggalluvial"><i class="fa fa-check"></i><b>12.4.1</b> ggalluvial<span></span></a></li>
<li class="chapter" data-level="12.4.2" data-path="multidimensional-categorical-variables.html"><a href="multidimensional-categorical-variables.html#geom_flow"><i class="fa fa-check"></i><b>12.4.2</b> geom_flow<span></span></a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="multidimensional-categorical-variables.html"><a href="multidimensional-categorical-variables.html#heat-map"><i class="fa fa-check"></i><b>12.5</b> Heat map<span></span></a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="spatial-data.html"><a href="spatial-data.html"><i class="fa fa-check"></i><b>13</b> Spatial data<span></span></a><ul>
<li class="chapter" data-level="13.1" data-path="spatial-data.html"><a href="spatial-data.html#introduction"><i class="fa fa-check"></i><b>13.1</b> Introduction<span></span></a></li>
<li class="chapter" data-level="13.2" data-path="spatial-data.html"><a href="spatial-data.html#packages"><i class="fa fa-check"></i><b>13.2</b> Packages<span></span></a><ul>
<li class="chapter" data-level="13.2.1" data-path="spatial-data.html"><a href="spatial-data.html#choroplethr"><i class="fa fa-check"></i><b>13.2.1</b> <code>choroplethr</code><span></span></a></li>
<li class="chapter" data-level="13.2.2" data-path="spatial-data.html"><a href="spatial-data.html#ggmap"><i class="fa fa-check"></i><b>13.2.2</b> <code>ggmap</code><span></span></a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">edav.info, 2nd edition</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="spatial-data" class="section level1 hasAnchor">
<h1><span class="header-section-number">Chapter 13</span> Spatial data<a href="spatial-data.html#spatial-data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The page is currently being updated, check back later.</p>
<div id="introduction" class="section level2 hasAnchor">
<h2><span class="header-section-number">13.1</span> Introduction<a href="spatial-data.html#introduction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this chapter, we will take a glimpse into spatial analysis using R. There are an overwhelming number of R packages for analyzing and visualizing spatial data. In broad terms, spatial visualizations require a merging of non-spatial and spatial information. For example, if you wish to create a choropleth map of the murder rate by county in New York State, you need county level data on murder rates, and you also need geographic data for drawing the county boundaries, stored in what are called shape files.</p>
<p>A rough divide exists between packages that don’t require you deal with shape files and those that do. The former work by taking care of the geographic data under the hood: you supply the data with a column for the location and the package takes care of figuring out how to draw those locations.</p>
</div>
<div id="packages" class="section level2 hasAnchor">
<h2><span class="header-section-number">13.2</span> Packages<a href="spatial-data.html#packages" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="choroplethr" class="section level3 hasAnchor">
<h3><span class="header-section-number">13.2.1</span> <code>choroplethr</code><a href="spatial-data.html#choroplethr" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Choropleth maps use color to indicate the value of a variable within a defined region, generally political boundaries. <code>choroplethr</code> is capable of drawing state and county level maps without using shape files.</p>
<p>Consider the following example using <code>state.x77</code> showing the percentage of illiterate in each states. Note the process of data transformation, you need to exactly have a column named ‘region’ with the state names and a column named ‘value’.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="spatial-data.html#cb131-1"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb131-2"><a href="spatial-data.html#cb131-2"></a><span class="kw">library</span>(tibble)</span>
<span id="cb131-3"><a href="spatial-data.html#cb131-3"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb131-4"><a href="spatial-data.html#cb131-4"></a><span class="kw">library</span>(choroplethr)</span>
<span id="cb131-5"><a href="spatial-data.html#cb131-5"></a></span>
<span id="cb131-6"><a href="spatial-data.html#cb131-6"></a><span class="co"># data frame must contain &quot;region&quot; and &quot;value&quot; columns</span></span>
<span id="cb131-7"><a href="spatial-data.html#cb131-7"></a></span>
<span id="cb131-8"><a href="spatial-data.html#cb131-8"></a>df_illiteracy &lt;-<span class="st"> </span>state.x77 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb131-9"><a href="spatial-data.html#cb131-9"></a><span class="st">  </span><span class="kw">rownames_to_column</span>(<span class="st">&quot;state&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb131-10"><a href="spatial-data.html#cb131-10"></a><span class="st">  </span><span class="kw">transmute</span>(<span class="dt">region =</span> <span class="kw">tolower</span>(<span class="st">`</span><span class="dt">state</span><span class="st">`</span>), <span class="dt">value =</span> Illiteracy)</span>
<span id="cb131-11"><a href="spatial-data.html#cb131-11"></a></span>
<span id="cb131-12"><a href="spatial-data.html#cb131-12"></a><span class="kw">state_choropleth</span>(df_illiteracy,</span>
<span id="cb131-13"><a href="spatial-data.html#cb131-13"></a>                 <span class="dt">title =</span> <span class="st">&quot;State Illiteracy Rates, 1977&quot;</span>,</span>
<span id="cb131-14"><a href="spatial-data.html#cb131-14"></a>                 <span class="dt">legend =</span> <span class="st">&quot;Percent Illiterate&quot;</span>)</span></code></pre></div>
<p><img src="spatial_files/figure-html/unnamed-chunk-1-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Plotting at county level is also possible. In the following example we show the population of counties in New York state in 2012.</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="spatial-data.html#cb132-1"></a><span class="kw">library</span>(choroplethrMaps)</span>
<span id="cb132-2"><a href="spatial-data.html#cb132-2"></a><span class="kw">data</span>(county.regions)</span>
<span id="cb132-3"><a href="spatial-data.html#cb132-3"></a><span class="kw">data</span>(df_pop_county) </span>
<span id="cb132-4"><a href="spatial-data.html#cb132-4"></a></span>
<span id="cb132-5"><a href="spatial-data.html#cb132-5"></a>ny_county_fips =<span class="st"> </span>county.regions <span class="op">%&gt;%</span></span>
<span id="cb132-6"><a href="spatial-data.html#cb132-6"></a><span class="st">  </span><span class="kw">filter</span>(state.name <span class="op">==</span><span class="st"> &quot;new york&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb132-7"><a href="spatial-data.html#cb132-7"></a><span class="st">  </span><span class="kw">select</span>(region)</span>
<span id="cb132-8"><a href="spatial-data.html#cb132-8"></a></span>
<span id="cb132-9"><a href="spatial-data.html#cb132-9"></a><span class="kw">county_choropleth</span>(df_pop_county, </span>
<span id="cb132-10"><a href="spatial-data.html#cb132-10"></a>                  <span class="dt">title =</span> <span class="st">&quot;Population of Counties in New York State in 2012&quot;</span>,</span>
<span id="cb132-11"><a href="spatial-data.html#cb132-11"></a>                  <span class="dt">legend =</span> <span class="st">&quot;Population&quot;</span>,</span>
<span id="cb132-12"><a href="spatial-data.html#cb132-12"></a>                  <span class="dt">county_zoom =</span> ny_county_fips<span class="op">$</span>region)</span></code></pre></div>
<p><img src="spatial_files/figure-html/unnamed-chunk-2-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>We use <code>county_choropleth</code> to create a U.S map at county level and zoom into New York state. Note that <code>county_zoom</code> takes in fips codes of counties. For more reference, visit the <a href="https://www.rdocumentation.org/packages/choroplethr/versions/3.7.0">R documentation page</a>.</p>
</div>
<div id="ggmap" class="section level3 hasAnchor">
<h3><span class="header-section-number">13.2.2</span> <code>ggmap</code><a href="spatial-data.html#ggmap" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>ggmap</code> is a great package to generate real-world maps. Moreover, it is compatible with <code>ggplot2</code> allowing you to easily add layers on top of the base map. There are two options in generating maps and we demonstrate one using stamenmap.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="spatial-data.html#cb133-1"></a><span class="kw">library</span>(ggmap)</span>
<span id="cb133-2"><a href="spatial-data.html#cb133-2"></a></span>
<span id="cb133-3"><a href="spatial-data.html#cb133-3"></a>ny_map &lt;-<span class="st"> </span><span class="kw">get_stamenmap</span>(<span class="dt">bbox =</span> <span class="kw">c</span>(<span class="dt">left =</span> <span class="fl">-74.2591</span>, <span class="dt">bottom =</span> <span class="fl">40.4774</span>, </span>
<span id="cb133-4"><a href="spatial-data.html#cb133-4"></a>                                 <span class="dt">right =</span> <span class="fl">-73.7002</span>, <span class="dt">top =</span> <span class="fl">40.9162</span>),</span>
<span id="cb133-5"><a href="spatial-data.html#cb133-5"></a>                        <span class="dt">zoom =</span> <span class="dv">10</span>, <span class="dt">maptype =</span> <span class="st">&quot;toner-lite&quot;</span>)</span>
<span id="cb133-6"><a href="spatial-data.html#cb133-6"></a></span>
<span id="cb133-7"><a href="spatial-data.html#cb133-7"></a><span class="kw">ggmap</span>(ny_map) <span class="op">+</span></span>
<span id="cb133-8"><a href="spatial-data.html#cb133-8"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span><span class="op">-</span><span class="fl">73.9857</span>,<span class="dt">y=</span><span class="fl">40.7484</span>),<span class="dt">size=</span><span class="fl">0.8</span>,<span class="dt">color=</span><span class="st">&#39;blue&#39;</span>) <span class="op">+</span></span>
<span id="cb133-9"><a href="spatial-data.html#cb133-9"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom=</span><span class="st">&quot;text&quot;</span>,<span class="dt">label=</span><span class="st">&quot;Empire State Building&quot;</span>,<span class="dt">x=</span><span class="op">-</span><span class="fl">73.9</span>, <span class="dt">y=</span><span class="fl">40.755</span>,<span class="dt">color=</span><span class="st">&#39;blue&#39;</span>,<span class="dt">size=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="spatial_files/figure-html/unnamed-chunk-3-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>A map of New York City is created, and we added the point representing Empire State Building. You can very simply add points using <code>geom_point</code> as long as you have the coordinates for the points. However, one clear drawback using stamenmap is that the map resolution is not satisfying and you will eventually find that the smaller zoom value creates blurry maps.</p>
<p>For this reason, we encourage readers to try the option using Google maps. You will need to set up a Google Cloud account (requires credit card). After enabling the Google map APIs, register you API keys with <code>ggmap</code> using <code>register_google(key = "[your key]")</code> and you are all set. Now take a look at the an example using Google map API</p>
<pre><code>ggmap(get_googlemap(center = c(lon = -74.006, lat = 40.7128),zoom = 14))</code></pre>
<center>
<img src="images/ggmap_google.png" style="width:70.0%" />
</center>
<p>You will see the map is at great resolution regardless of how you zoom in. For demonstration purpose, we provided a image of the map derived by running the code. For more details regarding the package usage, you can refer at <a href="https://github.com/dkahle/ggmap">ggmap GitHub page</a>.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="multidimensional-categorical-variables.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jtr13/edav2/edit/main/spatial.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/jtr13/edav2/blob/main/spatial.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
